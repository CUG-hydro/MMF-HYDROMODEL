# 1. 与河道交互

$$
K = K_{sat} e^{\frac{-z_{max} + 1.5}{f_{depth}}} \\

K = clamp(K, 0.1, 1.0)
$$


## 1.1. $z_{wt} > z_{river, surf}$

> 地下水补给河道

$$
RC = w l K / \Delta z \\ 
q = RC (h - z_{river}) \\ % [m s-1]
Q_{rf} = q \Delta t / area_{i,j} % [m]
$$

- `RC`: river conductance (河道传导率)，`m^2/s`
- `K` : 水力传导系数, `m/s`
- `w`: 河道宽度，`m`
- `l`: 河道长度，`m`
- $q$: m^3 s-1
- $Q_{rf}$: 河道流入量，`m` per time step

> 存在的问题：代码中没有除以$\Delta z$，即河床底部的厚度。

## 1.2. $z_{river, surf} >= z_{wt} > z_{river, bed}$

> 河道补给地下水，补给量受$z_{wt}$的影响

套用的公式相同，只不过，此时$q$为负值，同时限制排泄量不能高于河道水量。

$$
Q_{rf} = clamp(-q \Delta t / area_{i,j}, 0, d_{river})  f   % 正值
$$

其中，$f = \frac{w l}{area_{i,j}}$，是水量转换因子，将河道的水位深度转换为网格的深度。

## 1.3. $z_{wt} < z_{river, bed}$

